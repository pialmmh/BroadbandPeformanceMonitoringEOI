# Sub-Process: Register to BTRC Portal
# Parent: Onboard Partner ISP, Task 1

process:
  id: register-to-btrc-portal
  name: "Register to BTRC Portal"
  parentProcess: onboard-partner-isp
  parentTask: "1"
  breadcrumb: "Processes > Onboard Partner ISP > 1. Register to BTRC Portal"

lanes:
  - id: isp
    name: ISP
  - id: system
    name: System

elements:
  # ISP Lane
  - id: start
    type: start
    lane: isp

  - id: task-1-1
    type: task
    num: "1.1"
    name: Fill Company Information
    lane: isp
    sendsTo: receive-form

  - id: task-1-2
    type: task
    num: "1.2"
    name: Upload NID & Documents
    lane: isp
    sendsTo: receive-docs

  - id: receive-otp
    type: message-catch
    lane: isp
    receivesFrom: task-1-2b

  - id: task-1-3
    type: task
    num: "1.3"
    name: Enter OTP Code
    lane: isp
    sendsTo: receive-otp-entry

  - id: end
    type: end
    lane: isp

  # System Lane
  - id: receive-form
    type: message-catch
    lane: system
    receivesFrom: task-1-1

  - id: task-1-1a
    type: task
    num: "1.1.A"
    name: Validate Form Data
    lane: system

  - id: receive-docs
    type: message-catch
    lane: system
    receivesFrom: task-1-2

  - id: task-1-2a
    type: task
    num: "1.2.A"
    name: Verify NID via API
    lane: system

  - id: task-1-2b
    type: task
    num: "1.2.B"
    name: Send OTP
    lane: system
    sendsTo: receive-otp

  - id: receive-otp-entry
    type: message-catch
    lane: system
    receivesFrom: task-1-3

  - id: task-1-3a
    type: task
    num: "1.3.A"
    name: Verify OTP
    lane: system

messageFlows:
  - from: task-1-1
    to: receive-form
    direction: down

  - from: task-1-2
    to: receive-docs
    direction: down

  - from: task-1-2b
    to: receive-otp
    direction: up

  - from: task-1-3
    to: receive-otp-entry
    direction: down
