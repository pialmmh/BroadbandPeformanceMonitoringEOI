<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BPMN.js Demo - Onboard Partner ISP</title>
  <link rel="stylesheet" href="https://unpkg.com/bpmn-js@17/dist/assets/diagram-js.css">
  <link rel="stylesheet" href="https://unpkg.com/bpmn-js@17/dist/assets/bpmn-js.css">
  <link rel="stylesheet" href="https://unpkg.com/bpmn-js@17/dist/assets/bpmn-font/css/bpmn-embedded.css">
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 20px;
    }
    h1 {
      color: #1E3A5F;
      font-size: 18px;
      margin-bottom: 10px;
    }
    .a4-container {
      width: 605px;
      margin: 0 auto;
      background: #fff;
      padding: 15px;
      border: 1px solid #ccc;
    }
    #canvas {
      width: 100%;
      height: 400px;
      border: 1px solid #ddd;
    }
    .note {
      margin-top: 15px;
      padding: 10px;
      background: #fffde7;
      border: 1px solid #ffc107;
      font-size: 12px;
    }
  </style>
</head>
<body>

<div class="a4-container">
  <h1>Process: Onboard Partner ISP (bpmn-js)</h1>
  <div id="canvas"></div>
  <div class="note">
    <strong>Note:</strong> This uses bpmn-js library with BPMN 2.0 XML format.
    The diagram is fully compliant with BPMN 2.0 standard.
  </div>
</div>

<script src="https://unpkg.com/bpmn-js@17/dist/bpmn-navigated-viewer.production.min.js"></script>
<script>
// BPMN 2.0 XML - Standard format
const bpmnXML = `<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL"
                  xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
                  xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
                  xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
                  id="Definitions_1"
                  targetNamespace="http://btrc.gov.bd/bpmn">

  <bpmn:collaboration id="Collaboration_1">
    <bpmn:participant id="Participant_ISP" name="ISP" processRef="Process_ISP" />
    <bpmn:participant id="Participant_BTRC" name="BTRC Admin" processRef="Process_BTRC" />
    <bpmn:participant id="Participant_System" name="System" processRef="Process_System" />

    <bpmn:messageFlow id="MsgFlow_1" sourceRef="Task_Register" targetRef="Task_Review" />
    <bpmn:messageFlow id="MsgFlow_2" sourceRef="Gateway_Approve" targetRef="Task_Generate" />
    <bpmn:messageFlow id="MsgFlow_3" sourceRef="Task_Generate" targetRef="Event_ReceiveCreds" />
  </bpmn:collaboration>

  <bpmn:process id="Process_ISP" isExecutable="false">
    <bpmn:startEvent id="Start_ISP" name="Start" />
    <bpmn:subProcess id="Task_Register" name="1. Register to BTRC Portal" />
    <bpmn:intermediateCatchEvent id="Event_ReceiveCreds" name="Receive Credentials">
      <bpmn:messageEventDefinition />
    </bpmn:intermediateCatchEvent>
    <bpmn:task id="Task_Configure" name="3. Configure API Access" />
    <bpmn:endEvent id="End_ISP" name="End" />

    <bpmn:sequenceFlow id="Flow_1" sourceRef="Start_ISP" targetRef="Task_Register" />
    <bpmn:sequenceFlow id="Flow_2" sourceRef="Task_Register" targetRef="Event_ReceiveCreds" />
    <bpmn:sequenceFlow id="Flow_3" sourceRef="Event_ReceiveCreds" targetRef="Task_Configure" />
    <bpmn:sequenceFlow id="Flow_4" sourceRef="Task_Configure" targetRef="End_ISP" />
  </bpmn:process>

  <bpmn:process id="Process_BTRC" isExecutable="false">
    <bpmn:task id="Task_Review" name="1.A Review Application" />
    <bpmn:exclusiveGateway id="Gateway_Approve" name="Approved?" />

    <bpmn:sequenceFlow id="Flow_BTRC_1" sourceRef="Task_Review" targetRef="Gateway_Approve" />
  </bpmn:process>

  <bpmn:process id="Process_System" isExecutable="false">
    <bpmn:task id="Task_Generate" name="2. Generate Credentials" />
    <bpmn:task id="Task_APIKeys" name="3.A Create API Keys" />

    <bpmn:sequenceFlow id="Flow_Sys_1" sourceRef="Task_Generate" targetRef="Task_APIKeys" />
  </bpmn:process>

  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Collaboration_1">

      <!-- ISP Pool -->
      <bpmndi:BPMNShape id="Participant_ISP_di" bpmnElement="Participant_ISP" isHorizontal="true">
        <dc:Bounds x="20" y="20" width="550" height="100" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Start_ISP_di" bpmnElement="Start_ISP">
        <dc:Bounds x="80" y="52" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_Register_di" bpmnElement="Task_Register">
        <dc:Bounds x="140" y="40" width="100" height="60" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_ReceiveCreds_di" bpmnElement="Event_ReceiveCreds">
        <dc:Bounds x="272" y="52" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_Configure_di" bpmnElement="Task_Configure">
        <dc:Bounds x="340" y="40" width="100" height="60" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="End_ISP_di" bpmnElement="End_ISP">
        <dc:Bounds x="472" y="52" width="36" height="36" />
      </bpmndi:BPMNShape>

      <!-- BTRC Pool -->
      <bpmndi:BPMNShape id="Participant_BTRC_di" bpmnElement="Participant_BTRC" isHorizontal="true">
        <dc:Bounds x="20" y="140" width="550" height="100" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_Review_di" bpmnElement="Task_Review">
        <dc:Bounds x="140" y="160" width="100" height="60" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_Approve_di" bpmnElement="Gateway_Approve" isMarkerVisible="true">
        <dc:Bounds x="265" y="165" width="50" height="50" />
      </bpmndi:BPMNShape>

      <!-- System Pool -->
      <bpmndi:BPMNShape id="Participant_System_di" bpmnElement="Participant_System" isHorizontal="true">
        <dc:Bounds x="20" y="260" width="550" height="100" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_Generate_di" bpmnElement="Task_Generate">
        <dc:Bounds x="240" y="280" width="100" height="60" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_APIKeys_di" bpmnElement="Task_APIKeys">
        <dc:Bounds x="370" y="280" width="100" height="60" />
      </bpmndi:BPMNShape>

      <!-- Sequence Flows -->
      <bpmndi:BPMNEdge id="Flow_1_di" bpmnElement="Flow_1">
        <di:waypoint x="116" y="70" />
        <di:waypoint x="140" y="70" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_2_di" bpmnElement="Flow_2">
        <di:waypoint x="240" y="70" />
        <di:waypoint x="272" y="70" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_3_di" bpmnElement="Flow_3">
        <di:waypoint x="308" y="70" />
        <di:waypoint x="340" y="70" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_4_di" bpmnElement="Flow_4">
        <di:waypoint x="440" y="70" />
        <di:waypoint x="472" y="70" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_BTRC_1_di" bpmnElement="Flow_BTRC_1">
        <di:waypoint x="240" y="190" />
        <di:waypoint x="265" y="190" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Sys_1_di" bpmnElement="Flow_Sys_1">
        <di:waypoint x="340" y="310" />
        <di:waypoint x="370" y="310" />
      </bpmndi:BPMNEdge>

      <!-- Message Flows -->
      <bpmndi:BPMNEdge id="MsgFlow_1_di" bpmnElement="MsgFlow_1">
        <di:waypoint x="190" y="100" />
        <di:waypoint x="190" y="160" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="MsgFlow_2_di" bpmnElement="MsgFlow_2">
        <di:waypoint x="290" y="215" />
        <di:waypoint x="290" y="280" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="MsgFlow_3_di" bpmnElement="MsgFlow_3">
        <di:waypoint x="290" y="280" />
        <di:waypoint x="290" y="88" />
      </bpmndi:BPMNEdge>

    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>`;

// Initialize bpmn-js viewer
const viewer = new BpmnJS({
  container: '#canvas'
});

viewer.importXML(bpmnXML).then(function(result) {
  const { warnings } = result;
  if (warnings.length) {
    console.warn('BPMN import warnings:', warnings);
  }
  // Fit diagram to container
  viewer.get('canvas').zoom('fit-viewport');
}).catch(function(err) {
  console.error('Error rendering BPMN:', err);
});
</script>

</body>
</html>
